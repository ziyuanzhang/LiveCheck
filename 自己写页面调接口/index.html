<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Document</title>
	<script src="./js/jquery-3.6.0.min.js"></script>
	<style>
		.btn {
			width: 200px;
			height: 100px;
		}

		#myvideo {
			width: 500px;
			height: 400px;
		}

		#nei {
			width: 100px;
			height: 500px;
			word-break: break-all;
		}
	</style>
</head>

<body>
	<div>
		<span class="txt">名字</span>
		<input type="text" class="name">
	</div>
	<div>
		<span class="txt">身份证号</span>
		<input type="text" class="id">
	</div>
	<div>
		<button class="submit1">提交</button>
	</div>


	<div calss="btn">开始录制时，请眨眼-1- </div>
	<input class="recording" type="file" accept="video/*" capture="user" value="" />

	<script type="text/javascript">
		$(".submit1").click(function () {
			let data = {
				realName: $(".name").val(),
				certNo: $(".id").val()
			}
			$.get("http://quf17ix.nat.ipyingshe.com/loan/api/user/checkUserCertNo", data, function (res) {
				console.log("submit1:", res)
				if (res.status == 1) {
					console.log("shibai")
				} else {
					console.log("姓名:", res.msg)
				}

			})
		})
		$(".recording").change(function (e) {
			console.log("size:", (e.target.files[0].size) / 1024 / 1024)
			if ((e.target.files[0].size) / 1024 / 1024 > 5) {
				alert("超过5M了");
				$(".recording").val();
				return
			}


			var reader = new FileReader();
			reader.readAsDataURL(e.target.files[0]);
			reader.onload = function () {
				console.log("over1:")

				let data = {
					file: this.result
				}
				$.post("http://quf17ix.nat.ipyingshe.com/loan/api/common/fileUpload", data, function (res) {
					console.log("btn:", res)

					var data = {
						api_id: "3c280c123b4d46049302004e29dc0b33",
						api_secret: "ff8ffe2c38214cd68387c2afb80425ef",
						motions: "BLINK",
						liveness_data_url: res
					}
					console.log("over2:", JSON.stringify(data))
					$.post("https://cloudapi.linkface.cn/liveness/check_liveness", JSON.stringify(data),
						function (e) {
							console.log("huti:", e)
						})

				})
			}
		})
	</script>
</body>

</html>